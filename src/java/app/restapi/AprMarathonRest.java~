package app.restapi;

import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.core.MediaType;
import javax.ws.rs.core.Response;

import org.codehaus.jettison.json.JSONObject;


 @Path("/")
public class SparkHealthRestAPI {
       @POST
        @Path("/getRoles")
        @Consumes(MediaType.APPLICATION_JSON)
        @Produces(MediaType.APPLICATION_JSON)
        public Response performScaleOut(InputStream incomingData) {
                //StringBuilder crunchifyBuilder = new StringBuilder();

                JsonConverter jc = new JsonConverter(incomingData);

                JSONObject jObject = jc.getJsonObject();

                ClusterActions ca = new ClusterActions(jObject);
                JSONObject scaleStatus = ca.ScaleOut(jObject);


                // return HTTP response 200 in case of success
                //return Response.status(200).entity(scaleStatus.toString()).build();
                return Response.status(200).entity(scaleStatus.toString()).type(MediaType.APPLICATION_JSON).build();
        }

}
